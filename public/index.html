<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buscador OEM</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    padding: 20px;
}
.container {
    max-width: 1000px;
    margin: auto;
}
h1 {
    color: #222;
}
.search-box {
    background: #fff;
    padding: 20px;
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,.1);
    margin-bottom: 20px;
}
label {
    font-weight: bold;
}
input {
    width: 100%;
    padding: 10px;
    margin: 8px 0 15px;
    border-radius: 4px;
    border: 1px solid #ccc;
}
.options {
    margin-bottom: 15px;
}
button {
    background: #0056b3;
    color: #fff;
    padding: 10px 25px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
button:hover {
    background: #003f88;
}
.result {
    background: #fff;
    padding: 15px;
    border-radius: 6px;
    margin-bottom: 12px;
    box-shadow: 0 1px 4px rgba(0,0,0,.1);
    border-left: 5px solid transparent;
}
.result.exata {
    border-left: 5px solid #198754;
}
.codigo {
    font-weight: bold;
    font-size: 16px;
}
.badge {
    display: inline-block;
    padding: 4px 8px;
    font-size: 12px;
    border-radius: 4px;
    margin-top: 6px;
}
.badge.pdf {
    background: #dc3545;
    color: #fff;
}
.badge.html {
    background: #0d6efd;
    color: #fff;
}
.badge.exata {
    background: #198754;
    color: #fff;
}
.site {
    font-size: 12px;
    color: #555;
}
a {
    color: #0056b3;
    text-decoration: none;
}
a:hover {
    text-decoration: underline;
}
</style>
</head>

<body>
<div class="container">
    <h1>Buscador de Equival√™ncias OEM</h1>

    <div class="search-box">
        <label>Marca</label>
        <input id="marca" placeholder="Insira a marca!">

        <label>Refer√™ncia</label>
        <input id="ref" placeholder="Insira a refer√™ncia!">

        <div class="options">
            <input type="checkbox" id="somentePdf">
            <label for="somentePdf">Mostrar somente fichas t√©cnicas (PDF)</label>
        </div>

        <button onclick="buscar()">Buscar</button>
    </div>

    <div id="resultados"></div>
</div>

<script>
async function buscar() {
    const marca = document.getElementById("marca").value.trim();
    const ref = document.getElementById("ref").value.trim();
    const somentePdf = document.getElementById("somentePdf").checked;

    const resultadosDiv = document.getElementById("resultados");
    resultadosDiv.innerHTML = "üîé Buscando resultados...";

    if (!ref) {
        alert("Informe a refer√™ncia");
        return;
    }

    let url = `/api/buscar?referencia=${encodeURIComponent(ref)}&marca=${encodeURIComponent(marca)}`;

    if (somentePdf) {
        url += "&somentePdf=true";
    }

    const response = await fetch(url);
    const data = await response.json();

    resultadosDiv.innerHTML = "";

    if (!data.resultados || data.resultados.length === 0) {
        resultadosDiv.innerHTML = "<p>Nenhum resultado encontrado.</p>";
        return;
    }

    data.resultados.forEach(r => {
        const div = document.createElement("div");
        div.className = "result" + (r.equivalenciaExata ? " exata" : "");

        div.innerHTML = `
            <div class="codigo">üî¢ ${r.codigo}</div>
            <div>${r.descricao || "Descri√ß√£o n√£o dispon√≠vel"}</div>

            ${r.equivalenciaExata ? '<span class="badge exata">‚≠ê Equival√™ncia exata</span><br>' : ''}

            <span class="badge ${r.tipo === "PDF" ? "pdf" : "html"}">
                ${r.tipo === "PDF" ? "üìÑ Ficha t√©cnica (PDF)" : "üåê P√°gina Web"}
            </span><br><br>

            <a href="${r.link}" target="_blank">üîó Acessar</a><br>
            <span class="site">${r.site}</span>
        `;

        resultadosDiv.appendChild(div);
    });
}
</script>
</body>
</html>
